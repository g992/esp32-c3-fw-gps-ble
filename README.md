# ublox-gps-ble

Прошивка для Beetle ESP32-C3: читает NMEA от u-blox (и других приемников GPS) по UART, публикует координаты и статус по BLE, поддерживает Wi‑Fi точку доступа для OTA.

## Что нужно
- Плата Beetle ESP32-C3 (80 МГц) с USB-C.
- GPS-модуль u-blox с PPS (NEO-6/7/8/М10) на 3.3 В.
- Провода, при желании — два светодиода с резисторами и кнопка.
- Компьютер с установленным VSCode + PlatformIO.

## Подключение
- Питание GPS: 3V3 и GND от ESP32-C3, EN/POWER → GPIO7 (`GPS_EN`).
- UART: ESP32-C3 GPIO4 (TX) → RX GPS, GPIO3 (RX) ← TX GPS, скорость по умолчанию 38400 бод.
- PPS: GPIO6 (`GPS_PPS`) от выхода PPS модуля.
- Индикация (опционально): GPIO8 (распаян на плате) — статус (активный LOW), GPIO10 — режим (активный LOW).
- Кнопка AP (опционально): GPIO9 (на плате, кнопку BOOT) на GND, удержание ~5 с включает точку доступа.

## Сборка и прошивка
1) Подключите Beetle ESP32-C3 по USB.  
2) Проверьте `upload_port` и `monitor_port` в `platformio.ini`; смените под свой порт (изменение не коммитьте).  
3) Соберите и прошейте (гайдов очень много)
```  
После включения статусный светодиод показывает этапы загрузки, а BLE-маяк публикует координаты согласно протоколу ниже.

## Для разработчиков
- Вход: `src/main.cpp`, логика работы устройства — `src/firmware_app.cpp`, GPS/NMEA — `src/gps_controller.cpp`, BLE — `src/gps_ble.cpp`, OTA и веб — `src/ota_service.cpp`, `src/web_portal.cpp`.
- Пины и временные интервалы собраны в `include/gps_config.h`.
- UBX-последовательности для инициализации модема — `src/ubx_command_set.cpp`.
- Протокол BLE (UUID, полезная нагрузка) — `BLE_PROTOCOL.md`.
